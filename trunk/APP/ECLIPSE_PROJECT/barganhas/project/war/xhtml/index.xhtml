<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	template="/xhtml/bases/base.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:bargas="http://barganhas.com.br/barganhas">
	
	<ui:define name="bodyNavigation">
		<h:outputScript>
			try {
				$j(document).ready( function() {
					$j("#carroselLastAdvertisementLeft").click(function(){
						$j("#carroselLastAdvertisement").animate({"margin-left": "+=597px"}, "slow");
					});
					$j("#carroselLastAdvertisementRight").click(function(){
						$j("#carroselLastAdvertisement").animate({"margin-left": "-=597px"}, "slow");
					});
					$j("#carroselMostViewedLeft").click(function(){
						$j("#carroselMostViewed").animate({"margin-left": "+=597px"}, "slow");
					});
					$j("#carroselMostViewedRight").click(function(){
						$j("#carroselMostViewed").animate({"margin-left": "-=597px"}, "slow");
					});
				});
			} catch(e) {
				alert(e);
			}
		</h:outputScript>
	
		<h:panelGroup id="indexNavigationBox" layout="block">
			<h:panelGroup  id="categories" layout="blocl">
				<p class="title">#{msg.categories}</p>
				
				<ul>
					<ui:repeat var="category" value="#{siteBean.listCategories}">
						<li>
							<h:commandLink value="#{category.name}" action="#{siteBean.search}" >
								<f:setPropertyActionListener target="#{siteBean.categoryFilter}" value="#{category}"/>
							</h:commandLink>
						</li>
					</ui:repeat>
				</ul>
			</h:panelGroup>
			
			<h:panelGroup id="productsList" layout="block">
				<h:panelGroup layout="block" id="bannerSite" style="text-align: center;">
					<object width="550" height="403"
					classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
					codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0">
						<param name="SRC" value="#{request.contextPath}/images/banner/bargas_v2.swf"/>
						<embed src="#{request.contextPath}/images/banner/bargas_v2.swf" width="550" height="403">
						</embed>
					</object>
				</h:panelGroup>
				
				<h:panelGroup id="lastUpdates" layout="block">
					<p class="title">#{msg.lastAnnouncement}</p>
					
					<h:panelGroup class="carrosel" layout="block">
						<h:panelGroup id="carroselLastAdvertisementLeft" class="carroselLeftArrow" layout="block" >
							<h:graphicImage value="#{request.contextPath}/images/left-arrow-15x13.png" />
						</h:panelGroup>
						
						<h:panelGroup class="indexListItens" layout="block">
							<ul id="carroselLastAdvertisement">
								<ui:repeat var="advertisement" value="#{siteBean.lastAdvertisements}">
									<li>
										<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
											<h:graphicImage value="/fileserver?q=#{bargas:getStringFromKey(advertisement.sheetPicture.keyThumbnail)}"/>
										</a>
										
										<p class="descProduct">
											<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
												<h:outputText value="#{bargas:truncateString(advertisement.title, 35)}" />
											</a>
										</p>
										<p class="priceBox">
											<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
												<h:outputText value="#{msg.msgRealCurrency}"/>
												<h:outputText value="#{advertisement.value}">
													<f:converter converterId="ConverterCurrencyReal"/>
												</h:outputText>
											</a>
										</p>
									</li>
								</ui:repeat>
							</ul>
							
							<h:panelGroup id="carroselLastAdvertisementRight" class="carroselRightArrow" layout="block">
								<h:graphicImage value="#{request.contextPath}/images/right-arrow-15x13.png" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>

				<h:panelGroup id="mostViewed" layout="block">
					<p class="title">#{msg.mostViewed}</p>
					
					<h:panelGroup class="carrosel" layout="block">
						<h:panelGroup id="carroselMostViewedLeft" class="carroselLeftArrow" layout="block">
							<h:graphicImage value="#{request.contextPath}/images/left-arrow-15x13.png"/>
						</h:panelGroup>

						<h:panelGroup class="indexListItens" layout="block">
							<ul id="carroselMostViewed">
								<ui:repeat var="advertisement" value="#{siteBean.mostViewed}">
									<li>
										<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
											<h:graphicImage value="/fileserver?q=#{bargas:getStringFromKey(advertisement.sheetPicture.keyThumbnail)}"/>
										</a>
										
										<p class="descProduct">
											<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
												<h:outputText value="#{bargas:truncateString(advertisement.title, 35)}" />
											</a>
										</p>
										<p class="priceBox">
											<a href="#{request.contextPath}/xhtml/public/advertisementConsult.jsf?q=#{bargas:getStringFromKey(advertisement.key)}">
												<h:outputText value="#{msg.msgRealCurrency}"/>
												<h:outputText value="#{advertisement.value}">
													<f:converter converterId="ConverterCurrencyReal"/>
												</h:outputText>
											</a>
										</p>
									</li>
								</ui:repeat>
							</ul>
							
							<h:panelGroup id="carroselMostViewedRight" class="carroselRightArrow" layout="block">
								<h:graphicImage value="#{request.contextPath}/images/right-arrow-15x13.png"/>
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
				
				<h:panelGroup id="betterReputations" layout="block">
					<p class="title">#{msg.betterReputations}</p>
					
					<h:panelGroup class="carrosel" layout="block">
<!-- 						<h:panelGroup class="carroselLeftArrow" layout="block"> -->
<!-- 							<h:graphicImage value="#{request.contextPath}/images/left-arrow-15x13.png"/> -->
<!-- 						</h:panelGroup> -->
						
						<h:panelGroup class="indexListItens" layout="block">
							<ul>
								<ui:repeat var="user" value="#{siteBean.highlightedUsers}">
									<li>
										<a href="#">
											<h:graphicImage value="#{request.contextPath}/images/anonymous_profile.png"
												rendered="#{user.keyProfileImage eq null}"/>
											<h:graphicImage value="/fileserver?q=#{bargas:getStringFromKey(user.keyProfileImage)}"
												rendered="#{user.keyProfileImage ne null}"/>
										</a>
										
										<p class="descProduct"><a href="#">#{user.nickname}</a></p>
									</li>
								</ui:repeat>
							</ul>
							
<!-- 							<h:panelGroup class="carroselRightArrow" layout="block"> -->
<!-- 								<h:graphicImage value="#{request.contextPath}/images/right-arrow-15x13.png"/> -->
<!-- 							</h:panelGroup> -->
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			
			<h:panelGroup id="leftSide" layout="block">
			
				<c:choose>
					<!-- register yourself -->
					<c:when test="#{appSessionBean.userAccount eq null}">
						<p class="title">#{msg.registerYourSelf}</p>
						
						<h:panelGroup layout="block" id="registerBox" styleClass="boxLeftSide">
							<fieldset>
								<ol>
									<li>
										<h:outputLabel value="#{msg.registerName}:" for="userName" />
										<h:inputText id="userName" size="25" value="#{userAccountBean.userAccount.fullname}"/>
									</li>
									<li>
										<h:outputLabel value="#{msg.registerEmail}:" for="userEMail" />
										<h:inputText id="userEMail" size="25" value="#{userAccountBean.userAccount.email}"/>
									</li>
								</ol>
							</fieldset>
							
							<h:panelGroup id="userRegisterLogin" layout="block">
								<a4j:commandButton actionListener="#{userAccountBean.prepareRegister}"
											styleClass="customButton"
											id="registerUser"
											value="#{msg.registerYourSelf}"
											immediate="false"
											execute="registerBox"
											render="accountNewPopupForm"
											style="margin-right: 10px;"
											onclick="popupLoading(true);"
											oncomplete="popupLoading(false);"/>
											
								<h:commandLink value="#{msg.alreadyRegistered}" action="#{userAccountBean.goToLogin}"/>
							</h:panelGroup>
						</h:panelGroup>
					</c:when>
					<c:otherwise>
						<h:panelGroup id="mylastAdvertisements" layout="block" styleClass="boxLeftSide">
							<h:panelGroup layout="block" style="border-bottom: 2px solid #D5D5D5; padding: 0px 5px 5px 5px;">
								<h:outputText value="#{msg.userAccountMyLastAdvertisements}"/>
							</h:panelGroup>
							
							<c:choose>
								<c:when test="#{bargas:isCollectionOk(siteBean.myLastAdvertisements)}">
									<t:dataTable value="#{siteBean.myLastAdvertisements}" var="advertisement" style="width: 100%;">
										<h:column>
											<h:commandLink  action="#{advertisementBean.consult}">
												<h:panelGrid styleClass="myLastAdvertisementOne" style="width: 100%;">
													<!-- advertisement's description -->
													<h:outputText value="#{advertisement.title}"/>
	
													<!-- advertisement's value -->
													<h:panelGroup layout="block">
														<h:outputText value="#{msg.msgRealCurrency}"/>
														<h:outputText value="#{advertisement.value}">
															<f:converter converterId="ConverterCurrencyReal"/>
														</h:outputText>
													</h:panelGroup>
												</h:panelGrid>
												
												<f:setPropertyActionListener value="#{advertisement}" target="#{advertisementBean.advertisement}"/>
											</h:commandLink>
										</h:column>
									</t:dataTable>
								</c:when>
								<c:otherwise>
									<h:panelGroup id="boxNoneAdvertisementMy" layout="block">
										<h:outputText value=" #{msg.msgNoneAdvertisementToMe} "/>
										<h:commandLink value="#{msg.msgClickHere}" action="#{advertisementBean.prepareNewStepOne}"/>
										<h:outputText value=" #{msg.msgToCreateNewAdvertisement} "/>
									</h:panelGroup>
								</c:otherwise>
							</c:choose>
						</h:panelGroup>
						
						<object width="290" height="100"
							classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
							codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0">
							
							<param name="SRC" value="#{request.contextPath}/images/banner/Anuncie_v1.swf"/>
							<embed src="#{request.contextPath}/images/banner/Anuncie_v1.swf" width="290" height="100">
							</embed>
						</object>
						
					</c:otherwise>
				</c:choose>
				
				<h:panelGroup layout="block" styleClass="advertisementBannerRight">
					<h:graphicImage value="#{request.contextPath}/images/banner/nacprint-v3.png" />
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
	</ui:define>
</ui:composition>
