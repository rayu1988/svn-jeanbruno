<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="Author" content="Tim Stamp" />
<meta name="keywords" content="javascrypt, encryption, aes, javascript" />
<meta name="Source" content="http://www.fourmilab.ch/" />
<meta name="Author" content="Tim Stamp" />
<meta name="OriginalAuthor" content="John Walker" />
<meta name="OriginalAuthor" content="Fritz Schneider" />
<link href="../../icon.png" rev="contents" rel="shortcut icon" type="image/x-icon" />
<title>AES - JavaScript Crypto Library</title>
<script type="text/javascript" src="js/aes.js"></script>
<script type="text/javascript" src="js/entropy.js"></script>
<script type="text/javascript" src="js/aesprng.js"></script>
<script type="text/javascript" src="js/md5.js"></script>
<script type="text/javascript" src="js/jscrypt.js"></script>
<style type="text/css">
body {
  color: #333;
  font-family: Monospace;
  background-color: #ddd;
  margin: 10px;
  font-size: 9pt;
  background-image: url(../../img/bg_mech.png);
  background-repeat: no-repeat;
  background-position: top right;
}
input, select, textarea { font-family: Monospace; font-size:1em;}
a, img.a { border-width: 0px; color:#00f; text-decoration:none;}
.extlink { color: #f00; }
h1 { font-size: 1.5em; color: #000; }
h2 { font-size: 1.2em; margin: 1px; padding: 5px; color: #000; }
h3 { font-size: 1.1em; text-decoration: none; color: #000; }
p { width: 100%; }
td { padding: 1px 5px; }
</style>
<script type="text/javascript">
/* <![CDATA[ */
//	Our onLoad handler kicks off the collection of entropy
function nowLoaded() {    
    ce();	    	    	    	// Add time we got here to entropy
    mouseMotionEntropy(60);   	// Initialise collection of mouse motion entropy
}
function genkey() {
    //keylen for AES is 256 bit == 32 Byte == 64 Hex chars.
    var strvalue1 = Generate_key(); //generate key returns a 32 Byte key.
    document.getElementById("key").value = Generate_key();
}
function encrypt_string() {
    var input = document.getElementById("input").value;
    var key = document.getElementById("key").value;
    document.getElementById("output").value=Encrypt_Text(input, key);
}
function decrypt_string() {
    var input = document.getElementById("input").value;
    var key = document.getElementById("key").value;
    document.getElementById("output").value=Decrypt_Text(input, key);
}
function swap() {
    var src = document.getElementById("input");
    var dst = document.getElementById("output");
    var tmp = src.value;
    src.value = dst.value;
    dst.value = tmp;
}
/* ]]> */
</script>
</head><body onload="nowLoaded();">
<div>
<a href="../../main.html">[home]</a>
<a href="../../contents.html">[contents]</a>
<a href="files.html">[files]</a>
<a href="aes.html.md5">[md5]</a>
<a href="aes.html.sha1">[sha1]</a>
</div>

<h2>AES</h2>

<div>
<label for="key">256 bit Key (64 hexadecimal characters):</label><br />
<input type="text" id="key" style="width:100%" maxlength="75" onfocus="ce();" onblur="ce();" onkeydown="ce();" />
<input type="button" id="genkey" value="Generate Key" onclick="genkey();" />
<br />
<label for="input">Input:</label><br />
<textarea id="input" rows="10" cols="80" style="width:100%;" onfocus="ce();" onblur="ce();" onkeydown="ce();"></textarea>
<br />
<input type="button" id="encbut" value="Encrypt" onclick="encrypt_string();" />
<input type="button" id="decbut" value="Decrypt" onclick="decrypt_string();" />
<input type="button" onclick="swap()" value="Swap Fields" />
<input type="reset" value="Reset!" />
<br />
<label for="output">Output:</label><br />
<textarea id="output" rows="10" cols="80" style="width:100%;" onfocus="ce();" onblur="ce();" onkeydown="ce();"></textarea>
</div>
<p>
AES is the industry recognised version of the Rijndael encryption
algorithm, using a 256-bit key in CBC mode.
<br /><br />
If you enter a key that is longer than the stated key size, it will only 
use the key you enter upto the length of the full key size. Click the 
Generate button to see how long the key should be.<br />
Keys and ciphertext that contain non-hexadecimal characters will have them
removed before processing, thus newlines, spaces and other formatting
characters can be used safely.
<br /><br />
This algorithm has a bug or two - it doesn't completely decrypt
or encrypt a message correctly, when decrypting a message from
OpenSSL it skips the first 8 bytes, and when encrypting a message for 
decryption in OpenSSL, OpenSSL complains about
it being a 'bad decrypt', and mutters something about a digital
envelope. I believe this AES algorithm isn't creating encrypted 
messages according to the relevant standard.
<br /><br />  
The <b>Generate</b> button may be used to create a key sufficiently 
long to provide maximum security using a
high quality pseudorandom number generator seeded from:
</p>
<ul>
<li>the time the page was loaded, </li>
<li>the time you pressed the Generate button, </li>
<li>and the time of keystrokes and various other events
since the page was loaded.</li>
</ul>

<p>
<a class="extlink" type="text/html" href="http://jigsaw.w3.org/css-validator/check/referer">[W3C Valid CSS 2]</a><br />
<a class="extlink" type="text/html" href="http://validator.w3.org/check?uri=referer">[W3C Valid XHTML 1.1]</a>
</p>

</body>
</html>
