<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="Author" content="Tim Stamp" />
<meta name="Source" content="http://tero.co.uk/des/" />
<meta name="Source" content="http://www.fourmilab.ch/" />
<meta name="OriginalAuthor" content="John Walker" />
<meta name="OriginalAuthor" content="Fritz Schneider" />
<link href="../../icon.png" rev="contents" rel="shortcut icon" type="image/x-icon" />
<title>DES / 3DES - JavaScript Crypto Library</title>
<style type="text/css">
body {
  color: #333;
  font-family: Monospace;
  background-color: #ddd;
  margin: 10px;
  font-size: 9pt;
  background-image: url(../../img/bg_mech.png);
  background-repeat: no-repeat;
  background-position: top right;
}
input, textarea { font-family: Monospace; font-size:9pt;}
a, img.a { border-width: 0px; color:#00f; text-decoration:none;}
.extlink { color: #f00; }
h1 { font-size: 1.5em; color: #000; }
h2 { font-size: 1.2em; margin: 1px; padding: 5px; color: #000; }
h3 { font-size: 1.1em; text-decoration: none; color: #000; }
</style>
<script type="text/javascript" src="js/dessrc.js"></script>
<!-- key generator stuff - leave this out if you don't want to generate keys -->
<script type="text/javascript" src="../aes/js/aes.js"></script>
<script type="text/javascript" src="../aes/js/entropy.js"></script>
<script type="text/javascript" src="../aes/js/aesprng.js"></script>
<script type="text/javascript" src="../aes/js/md5.js"></script>
<script type="text/javascript" src="../aes/js/jscrypt.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
//	Our onLoad handler kicks off the collection of entropy for key generation
function nowLoaded() {    
    ce();	    	    	    	// Add time we got here to entropy
    mouseMotionEntropy(60);   	// Initialise collection of mouse motion entropy
}
function genkey() {
    //8 byte / 64 bit Key (DES) or 192 bit Key
    var strvalue = Generate_key();//generate key returns a 32 byte / 64 hex / 256 bit key.
    document.getElementById("key").value = strvalue.slice(0,48);
    document.getElementById("vector").value = strvalue.slice(48,64);
}
// end key generator stuff
function chars_from_hex(inputstr) {
	var outputstr = '';
	inputstr = inputstr.replace(/^(0x)?/g, '');
	inputstr = inputstr.replace(/[^A-Fa-f0-9]/g, '');
	inputstr = inputstr.split('');
	for(var i=0; i<inputstr.length; i+=2) {
		outputstr += String.fromCharCode(parseInt(inputstr[i]+''+inputstr[i+1], 16));
	}
	return outputstr;
}
function hex_from_chars(inputstr) {
	var delimiter = '';
	var outputstr = '';
	var hex = "0123456789abcdef";
	hex = hex.split('');
	var i, n;
	var inputarr = inputstr.split('');
	for(var i=0; i<inputarr.length; i++) {
		if(i > 0) outputstr += delimiter;
		if(!delimiter && i % 32 == 0 && i > 0) outputstr += '\n';
		n = inputstr.charCodeAt(i);
		outputstr += hex[(n >> 4) & 0xf] + hex[n & 0xf];
	}
	return outputstr;
}
function encrypt_string() {
    var input = document.getElementById("input").value;
    var key = document.getElementById("key").value;
    key = chars_from_hex(key);
    var vector = document.getElementById("vector").value;
    vector = chars_from_hex(vector);
    var vector = (vector.length > 7) ? vector : null;
    var output = des(key, input, 1, vector ? 1 : 0, vector);
    document.getElementById("output").value = hex_from_chars(output);
}
function decrypt_string() {
    var input = document.getElementById("input").value;
    var key = document.getElementById("key").value;
    key = chars_from_hex(key);
    var vector = document.getElementById("vector").value;
    vector = chars_from_hex(vector);
    var vector = (vector.length > 7) ? vector : null;
    input = chars_from_hex(input);
    document.getElementById("output").value = des(key, input, 0, vector ? 1 : 0, vector);
}
function swap() {
    var src = document.getElementById("input");
    var dst = document.getElementById("output");
    var tmp = src.value;
    src.value = dst.value;
    dst.value = tmp;
}
/* ]]> */
</script>

</head><body onload="nowLoaded();">
<div>
<a href="../../main.html">[home]</a>
<a href="../../contents.html">[contents]</a>
<a href="files.html">[files]</a>
<a href="aes.html.md5">[md5]</a>
<a href="aes.html.sha1">[sha1]</a>
</div>

<h2>DES / 3DES</h2>

<div>
<label for="key">64 bit Key (DES) or 192 bit Key (3DES) in Hexadecimal:</label><br />
<input type="text" id="key" style="width:100%" maxlength="75" onfocus="ce();" onblur="ce();" onkeydown="ce();" />
<input type="button" id="genkey" value="Generate Key" onclick="genkey();" />
<br />
<label for="input">Input:</label><br />
<textarea id="input" rows="10" cols="80" style="width:100%;" onfocus="ce();" onblur="ce();" onkeydown="ce();" ></textarea>
<br />
<input type="button" id="encbut" value="Encrypt" onclick="encrypt_string();" />
<input type="button" id="decbut" value="Decrypt" onclick="decrypt_string();" />
<input type="button" onclick="swap()" value="Swap" />
<label for="vector">Init Vector (IV):</label>
<input type="text" id="vector" size="16" onfocus="ce();" onblur="ce();" onkeydown="ce();" /><br />
<label for="output">Output:</label><br />
<textarea id="output" rows="10" cols="80" style="width:100%;" onfocus="ce();" onblur="ce();" onkeydown="ce();"></textarea>
</div>

<p>
To use a plaintext key or password to encrypt or decrypt a message here, use
the <b>ASCII functions</b> in this application to convert the string to 
Hexadecimal format.
<br /><br />
If you enter a 24 byte (character) key below it will use triple DES,
or else it expects an 8 byte key for single DES. ECB mode is used by default, but 
if you enter an 8 byte input vector it will use CBC mode.
<br /><br />
If you enter a key that is longer than the stated key size, it will only 
use the key you enter upto the length of the full key size. Click the 
Generate button to see how long the key should be.<br />
Keys and ciphertext that contain non-hexadecimal characters will have them
removed before processing, thus newlines, spaces and other formatting
characters can be used safely.
<br /><br />
The <b>Generate</b> button may be used to create a key sufficiently 
long to provide maximum security using a high quality pseudorandom 
number generator using the AES libraries, seeded from:
</p>
<ul>
<li>the time the page was loaded, </li>
<li>the time you pressed the Generate button, </li>
<li>and the time of keystrokes and various other events
since the page was loaded.</li>
</ul>

<p>
<a class="extlink" type="text/html" href="http://jigsaw.w3.org/css-validator/check/referer">[W3C Valid CSS 2]</a><br />
<a class="extlink" type="text/html" href="http://validator.w3.org/check?uri=referer">[W3C Valid XHTML 1.1]</a>
</p>
</body></html>